<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="768px" preserveAspectRatio="none" style="width:975px;height:768px;background:#FFFFFF;" version="1.1" viewBox="0 0 975 768" width="975px" zoomAndPan="magnify"><defs/><g><rect fill="#EEEEEE" height="749.9609" style="stroke:#D3D3D3;stroke-width:0.5;" width="393.5" x="215" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="92" x="365.75" y="18.0669">gRPC Server</text><rect fill="#EEEEEE" height="749.9609" style="stroke:#D3D3D3;stroke-width:0.5;" width="103" x="630.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="87" x="638.5" y="18.0669">gRPC Client</text><rect fill="#FFFFFF" height="374.0625" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="58" y="107.2344"/><line style="stroke:#181818;stroke-width:1.0;" x1="58" x2="58" y1="107.2344" y2="481.2969"/><line style="stroke:#181818;stroke-width:1.0;" x1="68" x2="68" y1="107.2344" y2="481.2969"/><line style="stroke:#181818;stroke-width:1.0;" x1="58" x2="68" y1="107.2344" y2="107.2344"/><rect fill="#FFFFFF" height="243.6641" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="58" y="509.2969"/><line style="stroke:#181818;stroke-width:1.0;" x1="58" x2="58" y1="509.2969" y2="752.9609"/><line style="stroke:#181818;stroke-width:1.0;" x1="68" x2="68" y1="509.2969" y2="752.9609"/><rect fill="#FFFFFF" height="39" style="stroke:#181818;stroke-width:1.0;" width="10" x="63" y="713.9609"/><rect fill="#FFFFFF" height="242.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="264" y="171.5"/><rect fill="#FFFFFF" height="28" style="stroke:#181818;stroke-width:1.0;" width="10" x="269" y="223.7656"/><rect fill="#FFFFFF" height="28" style="stroke:#181818;stroke-width:1.0;" width="10" x="269" y="320.0313"/><rect fill="#FFFFFF" height="89.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="509" y="654.8281"/><rect fill="#FFFFFF" height="89.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="677" y="384.1641"/><rect fill="#FFFFFF" height="104.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="677" y="580.5625"/><rect fill="#FFFFFF" height="374.0625" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="887" y="107.2344"/><line style="stroke:#181818;stroke-width:1.0;" x1="887" x2="887" y1="107.2344" y2="481.2969"/><line style="stroke:#181818;stroke-width:1.0;" x1="897" x2="897" y1="107.2344" y2="481.2969"/><line style="stroke:#181818;stroke-width:1.0;" x1="887" x2="897" y1="107.2344" y2="107.2344"/><rect fill="#FFFFFF" height="101.2656" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="887" y="509.2969"/><line style="stroke:#181818;stroke-width:1.0;" x1="887" x2="887" y1="509.2969" y2="610.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="897" x2="897" y1="509.2969" y2="610.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="887" x2="897" y1="610.5625" y2="610.5625"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="892" y="443.2969"/><rect fill="none" height="235.5313" style="stroke:#000000;stroke-width:1.5;" width="749.5" x="209" y="273.7656"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="63" x2="63" y1="56.4297" y2="66.4297"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="63" x2="63" y1="66.4297" y2="107.2344"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="63" x2="63" y1="107.2344" y2="481.2969"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="63" x2="63" y1="481.2969" y2="509.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="63" x2="63" y1="509.2969" y2="761.9609"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="269" x2="269" y1="56.4297" y2="66.4297"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="269" x2="269" y1="66.4297" y2="107.2344"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="269" x2="269" y1="107.2344" y2="481.2969"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="269" x2="269" y1="481.2969" y2="509.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="269" x2="269" y1="509.2969" y2="761.9609"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="513.5" x2="513.5" y1="56.4297" y2="66.4297"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="513.5" x2="513.5" y1="66.4297" y2="107.2344"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="513.5" x2="513.5" y1="107.2344" y2="481.2969"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="513.5" x2="513.5" y1="481.2969" y2="509.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="513.5" x2="513.5" y1="509.2969" y2="761.9609"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="681.5" x2="681.5" y1="56.4297" y2="66.4297"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="681.5" x2="681.5" y1="66.4297" y2="107.2344"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="681.5" x2="681.5" y1="107.2344" y2="481.2969"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="681.5" x2="681.5" y1="481.2969" y2="509.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="681.5" x2="681.5" y1="509.2969" y2="761.9609"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="891.5" x2="891.5" y1="56.4297" y2="66.4297"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="891.5" x2="891.5" y1="66.4297" y2="107.2344"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="891.5" x2="891.5" y1="107.2344" y2="481.2969"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="891.5" x2="891.5" y1="481.2969" y2="509.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="891.5" x2="891.5" y1="509.2969" y2="761.9609"/><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116" x="5" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="12" y="45.1279">Ankaios Server</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="219" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="226" y="45.1279">gRPC Server</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="181" x="423.5" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="167" x="430.5" y="45.1279">gRPC Agent Connection</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="95" x="634.5" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="641.5" y="45.1279">gRPC Client</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="835.5" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="842.5" y="45.1279">Ankaios Agent</text><rect fill="#FFFFFF" height="374.0625" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="58" y="107.2344"/><line style="stroke:#181818;stroke-width:1.0;" x1="58" x2="58" y1="107.2344" y2="481.2969"/><line style="stroke:#181818;stroke-width:1.0;" x1="68" x2="68" y1="107.2344" y2="481.2969"/><line style="stroke:#181818;stroke-width:1.0;" x1="58" x2="68" y1="107.2344" y2="107.2344"/><rect fill="#FFFFFF" height="243.6641" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="58" y="509.2969"/><line style="stroke:#181818;stroke-width:1.0;" x1="58" x2="58" y1="509.2969" y2="752.9609"/><line style="stroke:#181818;stroke-width:1.0;" x1="68" x2="68" y1="509.2969" y2="752.9609"/><rect fill="#FFFFFF" height="39" style="stroke:#181818;stroke-width:1.0;" width="10" x="63" y="713.9609"/><rect fill="#FFFFFF" height="242.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="264" y="171.5"/><rect fill="#FFFFFF" height="28" style="stroke:#181818;stroke-width:1.0;" width="10" x="269" y="223.7656"/><rect fill="#FFFFFF" height="28" style="stroke:#181818;stroke-width:1.0;" width="10" x="269" y="320.0313"/><rect fill="#FFFFFF" height="89.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="509" y="654.8281"/><rect fill="#FFFFFF" height="89.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="677" y="384.1641"/><rect fill="#FFFFFF" height="104.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="677" y="580.5625"/><rect fill="#FFFFFF" height="374.0625" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="887" y="107.2344"/><line style="stroke:#181818;stroke-width:1.0;" x1="887" x2="887" y1="107.2344" y2="481.2969"/><line style="stroke:#181818;stroke-width:1.0;" x1="897" x2="897" y1="107.2344" y2="481.2969"/><line style="stroke:#181818;stroke-width:1.0;" x1="887" x2="897" y1="107.2344" y2="107.2344"/><rect fill="#FFFFFF" height="101.2656" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="887" y="509.2969"/><line style="stroke:#181818;stroke-width:1.0;" x1="887" x2="887" y1="509.2969" y2="610.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="897" x2="897" y1="509.2969" y2="610.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="887" x2="897" y1="610.5625" y2="610.5625"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="892" y="443.2969"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="42" x="456.5" y="90.6401">Startup</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="968.5" x="0" y="127.8008"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="968.5" y1="127.8008" y2="127.8008"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="968.5" y1="130.8008" y2="130.8008"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="255" x="356.75" y="117.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="236" x="362.75" y="133.3013">Forward From Server messages</text><line style="stroke:#181818;stroke-width:1.0;" x1="262" x2="252" y1="171.5" y2="167.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="262" x2="252" y1="171.5" y2="175.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="68" x2="263" y1="171.5" y2="171.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="75" y="166.4341">send From Server message</text><line style="stroke:#181818;stroke-width:1.0;" x1="279" x2="321" y1="215.7656" y2="215.7656"/><line style="stroke:#181818;stroke-width:1.0;" x1="321" x2="321" y1="215.7656" y2="228.7656"/><line style="stroke:#181818;stroke-width:1.0;" x1="280" x2="321" y1="228.7656" y2="228.7656"/><polygon fill="#181818" points="290,224.7656,280,228.7656,290,232.7656" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="286" y="195.5669">use Common lib to find</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="286" y="210.6997">commands per Agent</text><path d="M209,273.7656 L286,273.7656 L286,280.8984 L276,290.8984 L209,290.8984 L209,273.7656 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="235.5313" style="stroke:#000000;stroke-width:1.5;" width="749.5" x="209" y="273.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="224" y="286.8325">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="108" x="301" y="285.9761">[for every Agent]</text><line style="stroke:#181818;stroke-width:1.0;" x1="279" x2="321" y1="312.0313" y2="312.0313"/><line style="stroke:#181818;stroke-width:1.0;" x1="321" x2="321" y1="312.0313" y2="325.0313"/><line style="stroke:#181818;stroke-width:1.0;" x1="280" x2="321" y1="325.0313" y2="325.0313"/><polygon fill="#181818" points="290,321.0313,280,325.0313,290,329.0313" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="286" y="306.9653">Find Agent tx in AgentSendersMap</text><line style="stroke:#181818;stroke-width:1.0;" x1="675" x2="665" y1="384.1641" y2="380.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="675" x2="665" y1="384.1641" y2="388.1641"/><line style="stroke:#181818;stroke-width:1.0;" x1="274" x2="676" y1="384.1641" y2="384.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245" x="281" y="379.0981">forward Exection Command over gRPC</text><line style="stroke:#181818;stroke-width:1.0;" x1="890" x2="880" y1="443.2969" y2="439.2969"/><line style="stroke:#181818;stroke-width:1.0;" x1="890" x2="880" y1="443.2969" y2="447.2969"/><line style="stroke:#181818;stroke-width:1.0;" x1="687" x2="891" y1="443.2969" y2="443.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="694" y="438.231">forward Exection Command</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="968.5" x="0" y="536.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="968.5" y1="536.8633" y2="536.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="968.5" y1="539.8633" y2="539.8633"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="234" x="367.25" y="526.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="215" x="373.25" y="542.3638">Forward To Server messages</text><line style="stroke:#181818;stroke-width:1.0;" x1="688" x2="698" y1="580.5625" y2="576.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="688" x2="698" y1="580.5625" y2="584.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="687" x2="886" y1="580.5625" y2="580.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="704" y="575.4966">send To Server message</text><line style="stroke:#181818;stroke-width:1.0;" x1="520" x2="530" y1="654.8281" y2="650.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="520" x2="530" y1="654.8281" y2="658.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="519" x2="676" y1="654.8281" y2="654.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="536" y="634.6294">forward To Server</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="536" y="649.7622">message over gRPC</text><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="84" y1="713.9609" y2="709.9609"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="84" y1="713.9609" y2="717.9609"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="73" x2="508" y1="713.9609" y2="713.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175" x="90" y="708.895">forward To Server message</text><!--MD5=[ceaf89cf1dce2addfb6ce4b0ab1a0336]
@startuml seq_forward_via_grpc
!include ../../../../resources/doc/plantuml/clean.skin

participant "Ankaios Server" as ankaios_server

box gRPC Communication Middleware #DarkGray
    box gRPC Server
        participant "gRPC Server" as grpc_server
        participant "gRPC Agent Connection" as agent_connection
    end box

    box gRPC Client
        participant "gRPC Client" as grpc_client
    end box
end box

participant "Ankaios Agent" as ankaios_agent


activate ankaios_server
activate ankaios_agent

... Startup ...

== Forward From Server messages ==

ankaios_server ->> grpc_server ++: send From Server message

grpc_server -> grpc_server ++- -: use Common lib to find\ncommands per Agent

loop for every Agent

    grpc_server -> grpc_server ++- -: Find Agent tx in AgentSendersMap

    grpc_server ->> grpc_client ++- -: forward Exection Command over gRPC

    grpc_client ->> ankaios_agent ++- -: forward Exection Command

    deactivate ankaios_agent

    ...

end

== Forward To Server messages ==

ankaios_agent ->> grpc_client ++- -: send To Server message

grpc_client ->> agent_connection ++- -: forward To Server\nmessage over gRPC

agent_connection - ->> ankaios_server ++- -: forward To Server message
@enduml

@startuml seq_forward_via_grpc
skinparam monochrome true
skinparam guillemet true
skinparam style strictuml
hide empty members
hide empty methods

skinparam class {
    BorderColor<<logical entity>> grey
    FontColor<<logical entity>> grey
    StereotypeFontColor<<logical entity>> grey
}

skinparam sequenceBox {
    BorderColor #LightGrey
    BackgroundColor #EEEEEE
    FontColor #777777
}

skinparam BoxPadding 10

skinparam note {
    BackgroundColor #FFFFFF
}

skinparam nodesep 30
skinparam ranksep 30

participant "Ankaios Server" as ankaios_server

box gRPC Communication Middleware #DarkGray
    box gRPC Server
        participant "gRPC Server" as grpc_server
        participant "gRPC Agent Connection" as agent_connection
    end box

    box gRPC Client
        participant "gRPC Client" as grpc_client
    end box
end box

participant "Ankaios Agent" as ankaios_agent


activate ankaios_server
activate ankaios_agent

... Startup ...

== Forward From Server messages ==

ankaios_server ->> grpc_server ++: send From Server message

grpc_server -> grpc_server ++- -: use Common lib to find\ncommands per Agent

loop for every Agent

    grpc_server -> grpc_server ++- -: Find Agent tx in AgentSendersMap

    grpc_server ->> grpc_client ++- -: forward Exection Command over gRPC

    grpc_client ->> ankaios_agent ++- -: forward Exection Command

    deactivate ankaios_agent

    ...

end

== Forward To Server messages ==

ankaios_agent ->> grpc_client ++- -: send To Server message

grpc_client ->> agent_connection ++- -: forward To Server\nmessage over gRPC

agent_connection - ->> ankaios_server ++- -: forward To Server message
@enduml

PlantUML version 1.2022.7(Mon Aug 22 17:01:30 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>