# Upgrading v0.7 to v1.0

We are proud to present the first stable version of Eclipse Ankaios.
This documents describes the necessary changes to update to the version if you are already using Ankaios.

## Manifest API version changes

The manifest `apiVersion` was updated from v0.1 to v1 marking our way towards stabilizing all Ankaios interfaces.

We took some efforts to ease up the transition as much as possible by maintaining backwards compatibility where this was possible at accepted by Ankaios input.

The output is now following the new syntax of version v1 which provides more possibilities and improvements.

### Tags are now a map

To add better support for filtering and especially event subscription capabilities for tags, we changed how tags are read and provided.

Previously tags were simple lists with of objects containing a key and a value:

```yaml
...
  tags:
    - key: tag_key
      value: tag_value
    - key: owner
      value: Ankaios
```

For improved access tags are now mappings with implicit keys:

```yaml
...
  tags:
    tag_key: tag_value
    owner: Ankaios
```

This imporves the accessability by allowing to filter the complete state for a distinct tag:

```bash
ank get state desiredState.workloads.*.tags.owner
```

Backwards compatibility to the old specification is still provided by the `ank-server` and `ank` CLI when reading manifests, but the CLI will not output in the old format anymore

### ControlInterfaceAccess filterMasks typo correction

A typo was corrected in the Ankaios manifest format that suggested that ControlInterface access rules support a single path only by naming the field `filterMask`:

```yaml
...
    controlInterfaceAccess:
      allowRules:
        - type: StateRule
          operation: Read
          filterMask:
            - "*"
```

As the field actually accepts an array the new formant is:

```yaml
...
    controlInterfaceAccess:
      allowRules:
        - type: StateRule
          operation: Read
          filterMasks:
            - "*"
```

Also here backwards compatibility is maintained and old manifests are still accepted.

### Agents attributes split

Agent resource usage attributes are now nested in the status field:

```yaml
...
agents:
  agent_A:
    status:
      cpuUsage: 4
      freeMemory: 5002276864
```

Whit this change we are preparing for an upcoming allowing agent tagging. Stay tuned for more information.
