<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="758px" preserveAspectRatio="none" style="width:1214px;height:758px;background:#FFFFFF;" version="1.1" viewBox="0 0 1214 758" width="1214px" zoomAndPan="magnify"><defs/><g><rect fill="#EEEEEE" height="739.9844" style="stroke:#D3D3D3;stroke-width:0.5;" width="716" x="16" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110" x="319" y="18.0669">Ankaios Server</text><rect fill="#EEEEEE" height="739.9844" style="stroke:#D3D3D3;stroke-width:0.5;" width="276" x="754" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="115" x="834.5" y="18.0669">Ankaios Agents</text><rect fill="#FFFFFF" height="227.9297" style="stroke:#181818;stroke-width:1.0;" width="10" x="71" y="160.9922"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="71" y="728.9844"/><rect fill="#FFFFFF" height="155.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="262" y="190.125"/><rect fill="#FFFFFF" height="28" style="stroke:#181818;stroke-width:1.0;" width="10" x="267" y="257.5234"/><rect fill="#FFFFFF" height="286.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="469" y="374.9219"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="654.5" y="131.8594"/><rect fill="#FFFFFF" height="21.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="787" y="110.7266"/><rect fill="#FFFFFF" height="65.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="787" y="442.1875"/><rect fill="#FFFFFF" height="28" style="stroke:#181818;stroke-width:1.0;" width="10" x="792" y="479.3203"/><rect fill="#FFFFFF" height="65.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="987" y="574.5859"/><rect fill="#FFFFFF" height="28" style="stroke:#181818;stroke-width:1.0;" width="10" x="992" y="611.7188"/><rect fill="none" height="385.3281" style="stroke:#000000;stroke-width:1.5;" width="1197" x="10" y="307.5234"/><rect fill="none" height="118.3984" style="stroke:#000000;stroke-width:1.5;" width="640" x="357" y="403.9219"/><rect fill="none" height="118.3984" style="stroke:#000000;stroke-width:1.5;" width="840" x="357" y="536.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="76" x2="76" y1="72.7266" y2="82.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="76" x2="76" y1="82.7266" y2="110.7266"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="76" x2="76" y1="110.7266" y2="751.9844"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="267" x2="267" y1="72.7266" y2="82.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="267" x2="267" y1="82.7266" y2="110.7266"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="267" x2="267" y1="110.7266" y2="751.9844"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="474" x2="474" y1="72.7266" y2="82.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="474" x2="474" y1="82.7266" y2="110.7266"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="474" x2="474" y1="110.7266" y2="751.9844"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="659" x2="659" y1="72.7266" y2="82.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="659" x2="659" y1="82.7266" y2="110.7266"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="659" x2="659" y1="110.7266" y2="751.9844"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="792" x2="792" y1="72.7266" y2="82.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="792" x2="792" y1="82.7266" y2="110.7266"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="792" x2="792" y1="110.7266" y2="751.9844"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="992" x2="992" y1="72.7266" y2="82.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="992" x2="992" y1="82.7266" y2="110.7266"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="992" x2="992" y1="110.7266" y2="751.9844"/><rect fill="#E3E3E3" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112" x="20" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="29.5" y="45.1279">&lt;&lt;thread&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="27" y="61.4248">AnkaiosServer</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94" x="220" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="227" y="61.4248">ServerState</text><rect fill="#E3E3E3" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="214" x="367" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="427.5" y="45.1279">&lt;&lt;thread&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="200" x="374" y="61.4248">GRPCCommunicationsServer</text><rect fill="#E3E3E3" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="137" x="591" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="613" y="45.1279">&lt;&lt;thread&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123" x="598" y="61.4248">tonic gRPC server</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68" x="758" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="765" y="61.4248">Agent 1</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68" x="958" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="965" y="61.4248">Agent 2</text><rect fill="#FFFFFF" height="227.9297" style="stroke:#181818;stroke-width:1.0;" width="10" x="71" y="160.9922"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="71" y="728.9844"/><rect fill="#FFFFFF" height="155.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="262" y="190.125"/><rect fill="#FFFFFF" height="28" style="stroke:#181818;stroke-width:1.0;" width="10" x="267" y="257.5234"/><rect fill="#FFFFFF" height="286.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="469" y="374.9219"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="654.5" y="131.8594"/><rect fill="#FFFFFF" height="21.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="787" y="110.7266"/><rect fill="#FFFFFF" height="65.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="787" y="442.1875"/><rect fill="#FFFFFF" height="28" style="stroke:#181818;stroke-width:1.0;" width="10" x="792" y="479.3203"/><rect fill="#FFFFFF" height="65.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="987" y="574.5859"/><rect fill="#FFFFFF" height="28" style="stroke:#181818;stroke-width:1.0;" width="10" x="992" y="611.7188"/><line style="stroke:#181818;stroke-width:1.0;" x1="665.5" x2="675.5" y1="131.8594" y2="127.8594"/><line style="stroke:#181818;stroke-width:1.0;" x1="665.5" x2="675.5" y1="131.8594" y2="135.8594"/><line style="stroke:#181818;stroke-width:1.0;" x1="664.5" x2="791" y1="131.8594" y2="131.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="681.5" y="126.7935">UpdateState</text><line style="stroke:#181818;stroke-width:1.0;" x1="82" x2="92" y1="160.9922" y2="156.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="82" x2="92" y1="160.9922" y2="164.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="81" x2="658.5" y1="160.9922" y2="160.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="98" y="155.9263">UpdateState</text><polygon fill="#181818" points="250,186.125,260,190.125,250,194.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="81" x2="256" y1="190.125" y2="190.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="88" y="185.0591">update state</text><line style="stroke:#181818;stroke-width:1.0;" x1="277" x2="319" y1="249.5234" y2="249.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="319" x2="319" y1="249.5234" y2="262.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="278" x2="319" y1="262.5234" y2="262.5234"/><polygon fill="#181818" points="288,258.5234,278,262.5234,288,266.5234" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="284" y="214.1919">create FromServer message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="284" y="229.3247">from comparison of new</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="284" y="244.4575">and old CurrentState</text><path d="M10,307.5234 L74,307.5234 L74,314.6563 L64,324.6563 L10,324.6563 L10,307.5234 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="385.3281" style="stroke:#000000;stroke-width:1.5;" width="1197" x="10" y="307.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="320.5903">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="79" x="89" y="319.7339">[State valid]</text><line style="stroke:#181818;stroke-width:1.0;" x1="82" x2="92" y1="345.7891" y2="341.7891"/><line style="stroke:#181818;stroke-width:1.0;" x1="82" x2="92" y1="345.7891" y2="349.7891"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="81" x2="266" y1="345.7891" y2="345.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="98" y="340.7231">FromServer message</text><line style="stroke:#181818;stroke-width:1.0;" x1="467" x2="457" y1="374.9219" y2="370.9219"/><line style="stroke:#181818;stroke-width:1.0;" x1="467" x2="457" y1="374.9219" y2="378.9219"/><line style="stroke:#181818;stroke-width:1.0;" x1="81" x2="468" y1="374.9219" y2="374.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="88" y="369.856">send FromServer message</text><line style="stroke:#181818;stroke-width:1.0;" x1="77" x2="87" y1="388.9219" y2="384.9219"/><line style="stroke:#181818;stroke-width:1.0;" x1="77" x2="87" y1="388.9219" y2="392.9219"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="76" x2="468" y1="388.9219" y2="388.9219"/><path d="M357,403.9219 L427,403.9219 L427,411.0547 L417,421.0547 L357,421.0547 L357,403.9219 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="118.3984" style="stroke:#000000;stroke-width:1.5;" width="640" x="357" y="403.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="372" y="416.9888">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="214" x="442" y="416.1323">[ExuectionsRequests for Agent 1]</text><line style="stroke:#181818;stroke-width:1.0;" x1="785" x2="775" y1="442.1875" y2="438.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="785" x2="775" y1="442.1875" y2="446.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="479" x2="786" y1="442.1875" y2="442.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="486" y="437.1216">send FromServer message</text><line style="stroke:#181818;stroke-width:1.0;" x1="802" x2="844" y1="471.3203" y2="471.3203"/><line style="stroke:#181818;stroke-width:1.0;" x1="844" x2="844" y1="471.3203" y2="484.3203"/><line style="stroke:#181818;stroke-width:1.0;" x1="803" x2="844" y1="484.3203" y2="484.3203"/><polygon fill="#181818" points="813,480.3203,803,484.3203,813,488.3203" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="809" y="466.2544">apply FromServer message</text><path d="M357,536.3203 L427,536.3203 L427,543.4531 L417,553.4531 L357,553.4531 L357,536.3203 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="118.3984" style="stroke:#000000;stroke-width:1.5;" width="840" x="357" y="536.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="372" y="549.3872">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="214" x="442" y="548.5308">[ExuectionsRequests for Agent 2]</text><line style="stroke:#181818;stroke-width:1.0;" x1="985" x2="975" y1="574.5859" y2="570.5859"/><line style="stroke:#181818;stroke-width:1.0;" x1="985" x2="975" y1="574.5859" y2="578.5859"/><line style="stroke:#181818;stroke-width:1.0;" x1="479" x2="986" y1="574.5859" y2="574.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="486" y="569.52">send FromServer message</text><line style="stroke:#181818;stroke-width:1.0;" x1="1002" x2="1044" y1="603.7188" y2="603.7188"/><line style="stroke:#181818;stroke-width:1.0;" x1="1044" x2="1044" y1="603.7188" y2="616.7188"/><line style="stroke:#181818;stroke-width:1.0;" x1="1003" x2="1044" y1="616.7188" y2="616.7188"/><polygon fill="#181818" points="1013,612.7188,1003,616.7188,1013,620.7188" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="1009" y="598.6528">apply FromServer message</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="1207" y1="662.7188" y2="662.7188"/><line style="stroke:#181818;stroke-width:1.0;" x1="77" x2="87" y1="684.8516" y2="680.8516"/><line style="stroke:#181818;stroke-width:1.0;" x1="77" x2="87" y1="684.8516" y2="688.8516"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="76" x2="266" y1="684.8516" y2="684.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113" x="93" y="679.7856">UpdateStateError</text><line style="stroke:#181818;stroke-width:1.0;" x1="76" x2="123" y1="715.9844" y2="715.9844"/><line style="stroke:#181818;stroke-width:1.0;" x1="123" x2="123" y1="715.9844" y2="728.9844"/><line style="stroke:#181818;stroke-width:1.0;" x1="82" x2="123" y1="728.9844" y2="728.9844"/><polygon fill="#181818" points="92,724.9844,82,728.9844,92,732.9844" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="88" y="710.9185">listen for incoming requests</text><!--MD5=[9b941b1d9c44338e947f661e9b67f5df]
@startuml seq_update_state
!include ../../../../resources/doc/plantuml/clean.skin

box "Ankaios Server"
participant "<<thread>>\nAnkaiosServer" as server
participant "ServerState" as server_state
participant "<<thread>>\nGRPCCommunicationsServer" as grpc_server
participant "<<thread>>\ntonic gRPC server" as tonic_server
end box


box "Ankaios Agents"
participant "Agent 1" as agent1
participant "Agent 2" as agent2
end box

activate agent1
...
agent1 ->> tonic_server- -++: UpdateState
tonic_server ->> server- -++: UpdateState
server -> server_state++: update state
server_state -> server_state++- -: create FromServer message\nfrom comparison of new\nand old CurrentState
alt State valid
server_state - ->> server- -: FromServer message
server ->> grpc_server++: send FromServer message
grpc_server - ->> server
deactivate server
opt ExuectionsRequests for Agent 1
grpc_server ->> agent1++:send FromServer message
agent1 -> agent1++- -: apply FromServer message
deactivate agent1
end
opt ExuectionsRequests for Agent 2
grpc_server ->> agent2++:send FromServer message
agent2 -> agent2++- -: apply FromServer message
deactivate agent2
end
deactivate grpc_server
else
server_state - ->> server: UpdateStateError
end
server -> server++: listen for incoming requests


@enduml

@startuml seq_update_state
skinparam monochrome true
skinparam guillemet true
skinparam style strictuml
hide empty members
hide empty methods

skinparam class {
    BorderColor<<logical entity>> grey
    FontColor<<logical entity>> grey
    StereotypeFontColor<<logical entity>> grey
}

skinparam sequenceBox {
    BorderColor #LightGrey
    BackgroundColor #EEEEEE
    FontColor #777777
}

skinparam BoxPadding 10

skinparam note {
    BackgroundColor #FFFFFF
}

skinparam nodesep 30
skinparam ranksep 30

box "Ankaios Server"
participant "<<thread>>\nAnkaiosServer" as server
participant "ServerState" as server_state
participant "<<thread>>\nGRPCCommunicationsServer" as grpc_server
participant "<<thread>>\ntonic gRPC server" as tonic_server
end box


box "Ankaios Agents"
participant "Agent 1" as agent1
participant "Agent 2" as agent2
end box

activate agent1
...
agent1 ->> tonic_server- -++: UpdateState
tonic_server ->> server- -++: UpdateState
server -> server_state++: update state
server_state -> server_state++- -: create FromServer message\nfrom comparison of new\nand old CurrentState
alt State valid
server_state - ->> server- -: FromServer message
server ->> grpc_server++: send FromServer message
grpc_server - ->> server
deactivate server
opt ExuectionsRequests for Agent 1
grpc_server ->> agent1++:send FromServer message
agent1 -> agent1++- -: apply FromServer message
deactivate agent1
end
opt ExuectionsRequests for Agent 2
grpc_server ->> agent2++:send FromServer message
agent2 -> agent2++- -: apply FromServer message
deactivate agent2
end
deactivate grpc_server
else
server_state - ->> server: UpdateStateError
end
server -> server++: listen for incoming requests


@enduml

PlantUML version 1.2022.7(Mon Aug 22 17:01:30 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>