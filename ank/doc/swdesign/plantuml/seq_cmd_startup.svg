<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="773px" preserveAspectRatio="none" style="width:1199px;height:773px;background:#FFFFFF;" version="1.1" viewBox="0 0 1199 773" width="1199px" zoomAndPan="magnify"><defs/><g><rect fill="#EEEEEE" height="754.5313" style="stroke:#D3D3D3;stroke-width:0.5;" width="1024" x="11" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="91" x="477.5" y="18.0669">Ankaios Ank</text><rect fill="#EEEEEE" height="754.5313" style="stroke:#D3D3D3;stroke-width:0.5;" width="124" x="1057" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110" x="1064" y="18.0669">Ankaios Server</text><rect fill="#FFFFFF" height="583.1641" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="129.5" y="132.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="129.5" x2="129.5" y1="132.5625" y2="715.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="139.5" x2="139.5" y1="132.5625" y2="715.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="129.5" x2="139.5" y1="132.5625" y2="132.5625"/><rect fill="#FFFFFF" height="1" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="129.5" y="756.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="129.5" x2="129.5" y1="756.5313" y2="757.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="139.5" x2="139.5" y1="756.5313" y2="757.5313"/><rect fill="#FFFFFF" height="318.4453" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="575" y="397.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="575" x2="575" y1="397.2813" y2="715.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="585" x2="585" y1="397.2813" y2="715.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="575" x2="585" y1="397.2813" y2="397.2813"/><rect fill="#FFFFFF" height="1" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="575" y="756.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="575" x2="575" y1="756.5313" y2="757.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="585" x2="585" y1="756.5313" y2="757.5313"/><rect fill="#FFFFFF" height="187.2891" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="806" y="528.4375"/><line style="stroke:#181818;stroke-width:1.0;" x1="806" x2="806" y1="528.4375" y2="715.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="816" y1="528.4375" y2="715.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="806" x2="816" y1="528.4375" y2="528.4375"/><rect fill="#FFFFFF" height="1" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="806" y="756.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="806" x2="806" y1="756.5313" y2="757.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="816" y1="756.5313" y2="757.5313"/><rect fill="#FFFFFF" height="56.1328" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="965" y="659.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="965" x2="965" y1="659.5938" y2="715.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="975" x2="975" y1="659.5938" y2="715.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="965" x2="975" y1="659.5938" y2="659.5938"/><rect fill="#FFFFFF" height="1" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="965" y="756.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="965" x2="965" y1="756.5313" y2="757.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="975" x2="975" y1="756.5313" y2="757.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="33" x2="33" y1="101.4297" y2="715.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="33" x2="33" y1="715.7266" y2="756.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="33" x2="33" y1="756.5313" y2="766.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="134.5" x2="134.5" y1="101.4297" y2="715.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="134.5" x2="134.5" y1="715.7266" y2="756.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="134.5" x2="134.5" y1="756.5313" y2="766.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="199.5" x2="199.5" y1="214.3438" y2="715.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="199.5" x2="199.5" y1="715.7266" y2="756.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="199.5" x2="199.5" y1="756.5313" y2="766.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="278.5" x2="278.5" y1="284.7734" y2="715.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="278.5" x2="278.5" y1="715.7266" y2="756.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="278.5" x2="278.5" y1="756.5313" y2="766.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="580" x2="580" y1="334.2188" y2="715.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="580" x2="580" y1="715.7266" y2="756.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="580" x2="580" y1="756.5313" y2="766.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="810.5" x2="810.5" y1="457.2266" y2="715.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="810.5" x2="810.5" y1="715.7266" y2="756.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="810.5" x2="810.5" y1="756.5313" y2="766.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="970" x2="970" y1="588.3828" y2="715.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="970" x2="970" y1="715.7266" y2="756.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="970" x2="970" y1="756.5313" y2="766.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1119" x2="1119" y1="101.4297" y2="715.7266"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1119" x2="1119" y1="715.7266" y2="756.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1119" x2="1119" y1="756.5313" y2="766.5313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="15" y="98.1279">user</text><ellipse cx="33.5" cy="33.6328" fill="#E3E3E3" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M33.5,41.6328 L33.5,68.6328 M20.5,49.6328 L46.5,49.6328 M33.5,68.6328 L20.5,83.6328 M33.5,68.6328 L46.5,83.6328 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="46" x="111.5" y="70.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="118.5" y="90.1279">Main</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116" x="1061" y="70.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="1068" y="90.1279">Ankaios Server</text><rect fill="#FFFFFF" height="583.1641" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="129.5" y="132.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="129.5" x2="129.5" y1="132.5625" y2="715.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="139.5" x2="139.5" y1="132.5625" y2="715.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="129.5" x2="139.5" y1="132.5625" y2="132.5625"/><rect fill="#FFFFFF" height="1" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="129.5" y="756.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="129.5" x2="129.5" y1="756.5313" y2="757.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="139.5" x2="139.5" y1="756.5313" y2="757.5313"/><rect fill="#FFFFFF" height="318.4453" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="575" y="397.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="575" x2="575" y1="397.2813" y2="715.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="585" x2="585" y1="397.2813" y2="715.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="575" x2="585" y1="397.2813" y2="397.2813"/><rect fill="#FFFFFF" height="1" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="575" y="756.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="575" x2="575" y1="756.5313" y2="757.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="585" x2="585" y1="756.5313" y2="757.5313"/><rect fill="#FFFFFF" height="187.2891" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="806" y="528.4375"/><line style="stroke:#181818;stroke-width:1.0;" x1="806" x2="806" y1="528.4375" y2="715.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="816" y1="528.4375" y2="715.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="806" x2="816" y1="528.4375" y2="528.4375"/><rect fill="#FFFFFF" height="1" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="806" y="756.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="806" x2="806" y1="756.5313" y2="757.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="816" y1="756.5313" y2="757.5313"/><rect fill="#FFFFFF" height="56.1328" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="965" y="659.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="965" x2="965" y1="659.5938" y2="715.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="975" x2="975" y1="659.5938" y2="715.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="965" x2="975" y1="659.5938" y2="659.5938"/><rect fill="#FFFFFF" height="1" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="965" y="756.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="965" x2="965" y1="756.5313" y2="757.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="975" x2="975" y1="756.5313" y2="757.5313"/><polygon fill="#181818" points="117.5,128.5625,127.5,132.5625,117.5,136.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="33.5" x2="123.5" y1="132.5625" y2="132.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="40.5" y="127.4966">a command</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1192" x="0" y="161.1289"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1192" y1="161.1289" y2="161.1289"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1192" y1="164.1289" y2="164.1289"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="73" x="559.5" y="150.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="54" x="565.5" y="166.6294">startup</text><polygon fill="#181818" points="172.5,185.6953,182.5,189.6953,172.5,193.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="139.5" x2="178.5" y1="189.6953" y2="189.6953"/><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="30" x="184.5" y="183.6953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="16" x="191.5" y="203.6904">Cli</text><polygon fill="#181818" points="187.5,242.125,197.5,246.125,187.5,250.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="139.5" x2="193.5" y1="246.125" y2="246.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="146.5" y="241.0591">parse</text><polygon fill="#181818" points="212.5,271.2578,222.5,275.2578,212.5,279.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="139.5" x2="218.5" y1="275.2578" y2="275.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19" x="146.5" y="270.1919">init</text><rect fill="#E3E3E3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109" x="224.5" y="254.125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="231.5" y="274.1201">CliCommands</text><line style="stroke:#181818;stroke-width:1.0;" x1="506" x2="496" y1="316.5547" y2="312.5547"/><line style="stroke:#181818;stroke-width:1.0;" x1="506" x2="496" y1="316.5547" y2="320.5547"/><line style="stroke:#181818;stroke-width:1.0;" x1="279" x2="507" y1="316.5547" y2="316.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205" x="286" y="311.4888">create and start in a new thread</text><rect fill="#E3E3E3" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="144" x="508" y="295.4219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="533.5" y="315.417">&lt;&lt;thread&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="515" y="331.7139">Middleware (gRPC)</text><line style="stroke:#181818;stroke-width:1.0;" x1="580" x2="627" y1="384.2813" y2="384.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="627" x2="627" y1="384.2813" y2="397.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="586" x2="627" y1="397.2813" y2="397.2813"/><polygon fill="#181818" points="596,393.2813,586,397.2813,596,401.2813" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="592" y="364.0825">start and endless loop</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217" x="592" y="379.2153">trying to (re)connect to the server</text><line style="stroke:#181818;stroke-width:1.0;" x1="743.5" x2="733.5" y1="431.4141" y2="427.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="743.5" x2="733.5" y1="431.4141" y2="435.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="585" x2="744.5" y1="431.4141" y2="431.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="592" y="426.3481">create an async task</text><rect fill="#E3E3E3" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="131" x="745.5" y="410.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="772.5" y="430.2764">&lt;&lt;task&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="752.5" y="446.5732">Listen to Ankaios</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="789" y="462.8701">Server</text><line style="stroke:#181818;stroke-width:1.0;" x1="811" x2="858" y1="515.4375" y2="515.4375"/><line style="stroke:#181818;stroke-width:1.0;" x1="858" x2="858" y1="515.4375" y2="528.4375"/><line style="stroke:#181818;stroke-width:1.0;" x1="817" x2="858" y1="528.4375" y2="528.4375"/><polygon fill="#181818" points="827,524.4375,817,528.4375,827,532.4375" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="823" y="495.2388">start listening for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="823" y="510.3716">FromServer messages</text><line style="stroke:#181818;stroke-width:1.0;" x1="907" x2="897" y1="562.5703" y2="558.5703"/><line style="stroke:#181818;stroke-width:1.0;" x1="907" x2="897" y1="562.5703" y2="566.5703"/><line style="stroke:#181818;stroke-width:1.0;" x1="585" x2="908" y1="562.5703" y2="562.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="592" y="557.5044">create an async task</text><rect fill="#E3E3E3" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="122" x="909" y="541.4375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="931.5" y="561.4326">&lt;&lt;task&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="916" y="577.7295">Listen to Agent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="940" y="594.0264">Manager</text><line style="stroke:#181818;stroke-width:1.0;" x1="970" x2="1017" y1="646.5938" y2="646.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="1017" x2="1017" y1="646.5938" y2="659.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="976" x2="1017" y1="659.5938" y2="659.5938"/><polygon fill="#181818" points="986,655.5938,976,659.5938,986,663.5938" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="982" y="626.395">start listening for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="982" y="641.5278">ToServer messages</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1192" x="0" y="693.1602"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1192" y1="693.1602" y2="693.1602"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1192" y1="696.1602" y2="696.1602"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="92" x="550" y="682.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="73" x="556" y="698.6606">command</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="88" x="532.25" y="739.937">implementation</text><!--MD5=[2777bd69b415d7942818673244785c2b]
@startuml seq_cmd_startup
!include ../../../../resources/doc/plantuml/clean.skin

box "Ankaios Ank"
    actor "user" as user
    participant Main as main
    participant "Cli" as cli
    participant "CliCommands" as cli_commands
    participant "<<thread>>\nMiddleware (gRPC)" as grpc_client
    participant "<<task>>\nListen to Ankaios\nServer" as listen_to_server
    participant "<<task>>\nListen to Agent \nManager" as listen_to_manager
end box

box "Ankaios Server"
    participant "Ankaios Server" as server
end box

user-> main ++ : a command

== startup ==

main -> cli **
main -> cli : parse
main -> cli_commands ** : init
cli_commands ->> grpc_client ** : create and start in a new thread

grpc_client -> grpc_client ++: start and endless loop \ntrying to (re)connect to the server
grpc_client ->> listen_to_server **: create an async task
listen_to_server -> listen_to_server ++: start listening for \nFromServer messages

grpc_client ->> listen_to_manager **: create an async task
listen_to_manager -> listen_to_manager ++: start listening for \nToServer messages

== command ==

... implementation ...

@enduml

@startuml seq_cmd_startup
skinparam monochrome true
skinparam guillemet true
skinparam style strictuml
hide empty members
hide empty methods

skinparam class {
    BorderColor<<logical entity>> grey
    FontColor<<logical entity>> grey
    StereotypeFontColor<<logical entity>> grey
}

skinparam sequenceBox {
    BorderColor #LightGrey
    BackgroundColor #EEEEEE
    FontColor #777777
}

skinparam BoxPadding 10

skinparam note {
    BackgroundColor #FFFFFF
}

skinparam nodesep 30
skinparam ranksep 30

box "Ankaios Ank"
    actor "user" as user
    participant Main as main
    participant "Cli" as cli
    participant "CliCommands" as cli_commands
    participant "<<thread>>\nMiddleware (gRPC)" as grpc_client
    participant "<<task>>\nListen to Ankaios\nServer" as listen_to_server
    participant "<<task>>\nListen to Agent \nManager" as listen_to_manager
end box

box "Ankaios Server"
    participant "Ankaios Server" as server
end box

user-> main ++ : a command

== startup ==

main -> cli **
main -> cli : parse
main -> cli_commands ** : init
cli_commands ->> grpc_client ** : create and start in a new thread

grpc_client -> grpc_client ++: start and endless loop \ntrying to (re)connect to the server
grpc_client ->> listen_to_server **: create an async task
listen_to_server -> listen_to_server ++: start listening for \nFromServer messages

grpc_client ->> listen_to_manager **: create an async task
listen_to_manager -> listen_to_manager ++: start listening for \nToServer messages

== command ==

... implementation ...

@enduml

PlantUML version 1.2022.7(Mon Aug 22 17:01:30 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>